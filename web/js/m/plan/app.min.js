(function(n){n.extend({toast:function(t){n.toaster!=void 0&&window.clearTimeout(n.toaster);var i=n("#gl_toast");return i.length==0&&(i=n('<div id="gl_toast"><div><\/div><div><\/div><\/div>'),i.children("div:eq(0)").click(function(){i.hide()}),n(document.body).append(i)),i.show().children("div:eq(1)").text(t),n.toaster=setTimeout(function(){i.hide()},3e3),n},hint:function(t,i){layer.open({content:t,skin:"msg",time:n.isNumeric(i)?i:2})},okmsg:function(t,i){var r=n("#gl_okmsg");return n.okmsgh=i,r.length==0&&(r=n('<div id="gl_okmsg"><div><\/div><div><p><\/p><a>确定<\/a><\/div><\/div>'),r.find("a").click(function(){n.isFunction(n.okmsgh)?n.okmsgh():r.remove()}),n(document.body).append(r)),r.show().find("p").text(t),n},yesno:function(t,i,r,u){var f=n("#gl_yesno");return n.yesnoh=i,f.length==0&&(f=n('<div id="gl_yesno"><div><\/div><div><p><\/p><a>'+(r?r:"确定")+"<\/a><a>"+(u?u:"取消")+"<\/a><\/div><\/div>"),f.children("div:eq(0)").click(function(){f.hide()}),f.find("a").eq(0).click(function(){n.yesnoh();f.hide()}).next().click(function(){f.hide()}),n(document.body).append(f)),f.show().find("p").text(t),n},loadr:function(t,i){var r=n("#gl_loadr");return r.length==0&&(r=n('<div id="gl_loadr"><div><\/div><div><i><\/i><p>加载中...<\/p><\/div><\/div>'),n(document.body).append(r)),t!=void 0&&r.find("p").html(t),r.show(),n.isFunction(i)?setTimeout(i,100):n.isNumeric(i)&&i==0&&r.fadeOut("fast"),n},t:{_i:"/Content/images/noimage.png",_s:10,a:function(){n.t._!=void 0&&(n.t.r=!0,n.t.m("加载中..."),n.post(n.t._,{a:n.t.i},n.t.s,"json").fail(n.t.f))},f:function(){n.t.r=!1;n.t.m("连接服务器失败")},i:1,m:function(t){t==void 0||t==""?n.t.n.hide():n.t.n.text(t).show()},n:n(".nodata").click(function(){n.t.a()}),s:function(t){if(n.t.r=!1,t==void 0||t.b.length==0||typeof t.b!="object"){n.t.m("没有更多了");return}n.t.m(t.b.length<n.t._s?"没有更多了":"下拉加载更多");n.t.i=t.a;n.t.v(t.b)}}});n(window).scroll(function(){n.t==void 0||n.t.r||n.t.b||!n.t.a||n(window).height()+n(window).scrollTop()+1>=n("body").height()&&n.t.a()}),function(){var i=n("#gl_upload"),t,o,r,e,s,u,h,f,a,c,l,v;if(i.length!=0){n.max_file_num=6;n.max_file_size=5242880;n.file_index=0;n.file_accept="image/gif,image/jpeg,image/jpg,image/png";i.on("click","p span",function(){var t=n(this).parent();n.yesno("确定移除该照片？",function(){var r,u;if(t!=null){var o=parseInt(t.attr("data"),10),f=t.attr("index"),e=i.children("div").find("input");for(t.remove(),t=null,i.find("i").show(),i.find("img").length<=2&&i.css("text-align","left"),r=0;r<e.length;r++)if(u=e.eq(r),f==u.attr("index")){u.remove();i.children("p").each(function(){n(this).attr("index")==f&&n(this).remove()});break}}})});i.on("change","i input",function(){var r=this.files?this.files:[],f,t,e;if(r.length&&window.FileReader){var u=r.length,o=[],s=i.find("img").length;for(n.file_index++,t=0;t<u;t++)if(o.push('<p index="'+n.file_index+'" data="'+t+'"><img /><span><a><\/a><b><\/b><\/span><\/p>'),r[t].size>n.max_file_size){n.hint("单张最大"+parseInt(n.max_file_size/1048576,10)+"MB");return}if(u+s>n.max_file_num){n.hint("最多上传"+n.max_file_num+"张照片");return}for(u+s==n.max_file_num&&i.find("i").hide(),(i.find("img").length>=2||u>2)&&i.css("text-align","center"),f=n(this).parent(),t=0;t<r.length;t++)/^image/.test(r[t].type)&&(n.loadr("加载中"),e=new FileReader,e.readAsDataURL(r[t]),e.onloadend=function(){var t,r;u--;t=n(o.pop());t.find("img").attr("src",this.result);f.before(t);u<=0&&(f.children("input").attr({name:"file",index:n.file_index}).appendTo(i.find("div")),r=n('<input type="file" accept="'+n.file_accept+'" multiple="multiple" />'),f.append(r),n.loadr(null,0))})}})}if(t=n(document.body).children("section"),o=n(".zzzz"),t.length!=0){if(r=t.attr("class"),r=="mcaa"){n.extend(n.t,{_:"/my/cardorders",_a:0,a:function(){n.t._!=void 0&&(n.t.r=!0,n.t.m("加载中..."),n.post(n.t._,{_:0,a:n.t.i,b:n.t._a},n.t.s,"json").fail(n.t.f))},v:function(t){var r,i;if(t.length!=0)for(r=0;r<t.length;r++)i='<div class="mcab" data-value="'+t[r].a+'">',i+="<p><i>订单号："+t[r].a+"<\/i><b>"+t[r].k+"<\/b><\/p>",i+='<h2><a href="'+t[r].c+'">'+t[r].d+"<\/a><\/h2>",i+='<div class="mcac">',i+='<a href="'+t[r].c+'"><img src="'+t[r].e+'" onerror="this.src=\''+n.t._i+"'\" /><\/a>",i+="<p>下单时间："+t[r].f+"<\/p>",i+="<p>有效期："+t[r].g+"年<\/p>",i+="<p>卡片类型："+(t[r].i==0?"体验卡":"旅居卡")+"<\/p>",i+="<\/div>",i+='<div class="mcad">',i+="<p>价格：<b>￥"+t[r].j+"<\/b><\/p>",i+="<p>",t[r].b==0&&(i+="<i>取消订单<\/i>"),i+='<a href="/my/cardorderdetail/'+t[r].a+'">订单详情<\/a>',i+="<\/p>",i+="<\/div>",i+="<\/div>",n.t.n.before(i)}});n(".mcae").children("a").click(function(){n(this).addClass("hover").siblings().removeClass();n.t._a=n(this).data("val");n.t.n.prevAll().remove();n.t.i=1;n.t.a()});t.on("click",".mcad i",function(){var t=n(this),i=t.parents(".mcab").data("value");n.post(n.t._,{_:1,a:i},function(i){n.hint(i.b);i.a==1&&(t.parents(".mcab").children("p").eq(0).children("b").text("已取消"),t.remove())},"json")})}else r=="mcbj"?(n.t._="/my/cardorders",t.find(".mcbf").click(function(){n.post(n.t._,{_:1,a:t.data("value")},function(i){n.hint(i.b);i.a==1&&(t.find(".mcba b").text("已取消"),t.find(".mcbe").remove())},"json")})):r=="hfae"?t.find(".hfaa a").click(function(){var i=n.trim(t.find(".title input").val());if(i==""){n.hint("请输入关键词");return}window.location.href="/search/r3/?q="+encodeURI(i)}):r=="hcdg"?t.find(".hfde a").click(function(){var i=n.trim(t.find("textarea").val()),r=n.trim(t.find(".hfdd input").val()),u;if(i==""){n.hint("请输入反馈意见");return}if(i.length<10){n.hint("反馈意见不能少于10个字");return}if(r!=""&&!/^1\d{10}$/.test(r)){n.hint("手机号码格式不正确！");return}if(!n.requesting){if(u=n.trim(n("textarea").val()),u.length<10){n.hint("评价不能少于10个字");return}n.requesting=!0;n("form").ajaxSubmit({url:"/help/feedback",type:"POST",dataType:"json",error:function(){n.requesting=!1;n.loadr(null,0).hint("连接服务器失败")},success:function(i){if(n.requesting=!1,i.a!=1){n.loadr(null,0).hint(i.b);return}n.loadr(0,0).hint("提交成功！");t.find(".hfdf").show().siblings().remove()},uploadProgress:function(t,i,r,u){u==100?n.loadr("正在校验文件..."):n.loadr("上传中，请稍等..."+u+"%")}})}}):r=="hcea"?(e=t.children(".hceg"),t.children(".hceb").find("p").click(function(){e.fadeIn()}),e.click(function(){e.fadeOut()})):r=="hcga"?(s=t.children(".hcge"),u=t.children(".hcgg"),s.find("a").click(function(){var t,i;n(this).hasClass("hcgf")||(t=n(this).index(),n(this).addClass("hcgf").siblings().removeClass("hcgf"),s.find("p i").css("margin-left",t*25+"%"),u.children().hide(),t==0?i=u.children():t==1?i=u.children().filter('[a="0"]'):t==2?i=u.children().filter('[a="1"]'):t==3&&(i=u.children().filter('[a="2"]')),i.length==0?u.children(".nodata").length==0?u.append('<div class="nodata">暂无数据<\/div>'):u.children(".nodata").show():i.fadeIn())})):r=="hoaa"?(h=t.children(".hoac"),f=t.children(".hoad"),h.find("a").click(function(){var t,i,r;n(this).hasClass("hcgf")||(t=n(this).index(),n(this).addClass("hcgf").siblings().removeClass("hcgf"),h.find("p i").css("margin-left",t*33.33+"%"),f.children(".hoaj").length==0&&(t==0?(i=f.children().hide().filter(".hoak"),i.length==0?f.children(".nodata").fadeIn():i.fadeIn()):t==1?(r=f.children().hide().filter(".hoal"),r.length==0?f.children(".nodata").fadeIn():r.fadeIn()):f.children().hide().not(".nodata").fadeIn()))}),f.children(".hoak").length==0&&f.children(".nodata").fadeIn()):r=="aiaa"?(a=t.find(".aiab input"),t.find(".aiac a").click(function(){var t=n.trim(a.val());if(t==""){n.hint("请输入内部员工手机号码");return}if(!/^1\d{10}$/.test(t)){n.hint("手机号码格式不正确");return}n.post("/agency/internaladd",{phone:t},function(t){t.a!=1?n.hint(t.b):(n.hint("添加成功"),setTimeout(function(){location.href="/agency/agencyteam"},1e3))},"json")})):r=="hoba"&&(c=n(".hcaa .right"),c.click(function(){var r=t.children(".hobb"),i;if(n(this).text()=="完成"){i="";r.each(function(){n(this).find("p input").is(":checked")&&(i+=n(this).attr("uid")+",")});i!=""&&(i=i.substring(0,i.length-1));n.post("/house/ownerhouse",{uids:i},function(t){if(t.a==1){window.location.reload();return}n.hint(t.b)},"json");return}n(this).text("完成");r.children("p").show();r.attr("href","javascript:").click(function(t){if(!n(t.target).is("input")){var i=n(this).children("p").children("input");i.prop("checked",!i.is(":checked"))}});r.each(function(){n(this).attr("check")=="1"&&n(this).children("p").children("input").prop("checked",!0)})}),t.children("a").click(function(){if(c.text()!="完成")return n(this).attr("check")!="1"?(n.okmsg("您尚未关联业主，不能直接访问。请先点“编辑”并“选中”业主房源。"),!1):void 0}));o.length==0?(n.t.i=1,n.t.a()):(l=n.trim(o.html()),l==""?n.t.n("没有更多了"):(v=JSON.parse(l),n.t.s(v)))}}()})(window.jQuery);